################################################################################
# Analysis of predictd chromatin looping interactions using the chromloop tool
################################################################################


require(chromloop)   # devtools::install_github("ibn-salem/chromloop")
require(tidyverse)


# parse metatdata table for input files

meta <- read_tsv("data/ENCODE/metadata.flt.tsv")

# DEBUG: 
# work only on subset here:
meta <- meta %>% top_n(3)
#-------------------------------------------------------------------------------
# 1) take motifs
#-------------------------------------------------------------------------------
ancGR <- chromloop::motif.hg19.CTCF

#-------------------------------------------------------------------------------
# 2) annotae with coverage 
#-------------------------------------------------------------------------------
covRLle <- lapply(meta$filePath, parseBigWigToRle, seqInfo = seqinfo(ancGR))

#-------------------------------------------------------------------------------
# 3) build InteractonSet object
#-------------------------------------------------------------------------------


#-------------------------------------------------------------------------------
# 4) compute correlations
#-------------------------------------------------------------------------------


#-------------------------------------------------------------------------------
# 5) add ture loops
#-------------------------------------------------------------------------------


#-------------------------------------------------------------------------------
# 6) predict loops
#-------------------------------------------------------------------------------


#-------------------------------------------------------------------------------
# 7)  Analyse performace
#-------------------------------------------------------------------------------

